import{b4 as a,b5 as n,b6 as e,b7 as u,b8 as r,b9 as P,ba as w,bb as f,bc as i,bd as y,be as h,bf as d,bg as B,bh as k,bi as C,bj as A}from"./index.44184293.js";async function _(t){const o=await a(n(e,"users",t));if(o.exists()){const s=o.data();return{id:t,...s,createdAt:s.createdAt.toDate()}}return null}async function v(t){return(await B(i(e,"posts"),{...t,readCount:0,likeCount:0,commentCount:0,bookmarkCount:0,createdAt:d()})).id}async function L(t){const o=[];t!=null&&t.category&&o.push(u("category","==",t==null?void 0:t.category)),(t==null?void 0:t.tags)&&(t==null?void 0:t.tags.length)>0&&o.push(u("tags","array-contains-any",t==null?void 0:t.tags)),t!=null&&t.sort&&o.push(r(t.sort,"desc")),t!=null&&t.start&&o.push(P(t.start)),t!=null&&t.limit&&o.push(w(t.limit));const s=f(i(e,"posts"),...o),c=await y(s),S=c.docs.map(b=>{var l;const g=b.data();return{...g,id:b.id,createdAt:(l=g.createdAt)==null?void 0:l.toDate()}}),q=c.docs[c.docs.length-1];return{items:S,lastItem:q}}async function D(t){var c;const o=await a(n(e,"posts",t));if(!o.exists())throw new Error("No such document");const s=o.data();return{id:o.id,...s,createdAt:(c=s.createdAt)==null?void 0:c.toDate()}}async function $(t){await h(n(e,"posts",t),{readCount:C(1)})}async function R(t){await $(t);const o=await D(t),s=await _(o.uid);return{post:o,postUser:s}}async function U(t,o){await h(n(e,"posts",t),{...o,updatedAt:d()})}async function j(t){await k(n(e,"posts",t))}async function T(t,o){A(n(e,"post_likes",`${t}_${o}`),{uid:t,postId:o,createdAt:d()})}async function E(t,o){k(n(e,"post_likes",`${t}_${o}`))}async function I(t,o){return(await a(n(e,"post_likes",`${t}_${o}`))).exists()}async function N(t,o){await A(n(e,"users",t,"bookmarks",o),{createdAt:d()})}async function z(t,o){await k(n(e,"users",t,"bookmarks",o))}async function F(t,o){return(await a(n(e,"users",t,"bookmarks",o))).exists()}async function G(t){const o=f(i(e,"users",t,"bookmarks"),r("createdAt","desc"),w(6)),s=await y(o);return Promise.all(s.docs.map(c=>D(c.id)))}async function H(){const t=f(i(e,"tags"),u("count",">",0),r("count","desc"));return(await y(t)).docs.map(s=>s.data())}export{L as a,_ as b,v as c,T as d,F as e,z as f,H as g,I as h,N as i,G as j,R as k,j as l,D as m,E as r,U as u};
